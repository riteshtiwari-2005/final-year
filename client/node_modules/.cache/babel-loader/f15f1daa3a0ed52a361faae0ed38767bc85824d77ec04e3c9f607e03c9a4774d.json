{"ast":null,"code":"var _jsxFileName = \"D:\\\\finalyear-2\\\\Ger-s-Garage\\\\client\\\\src\\\\Components\\\\Products.jsx\",\n  _s = $RefreshSig$();\nimport { useQuery } from \"@tanstack/react-query\";\nimport styled from \"styled-components\";\nimport { publicRequest } from \"../Utils/requestMethods\";\nimport { mobile, special, tablet } from \"../Utils/responsive\";\nimport Product from \"./Home/Product\";\nimport Loading from \"./Loading\";\nimport { useEffect, useState } from \"react\";\nimport { Pagination } from \"@mui/material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Products = _ref => {\n  _s();\n  let {\n    filters,\n    sort,\n    page\n  } = _ref;\n  const [filteredProducts, setFilteredProducts] = useState([]);\n  const [pages, setPages] = useState(0);\n  let content;\n  let totalPages;\n  const {\n    data: products,\n    isFetching\n  } = useQuery({\n    queryKey: [\"productsData\"],\n    queryFn: async () => {\n      const res = await publicRequest.get(\"/products/\");\n      // console.log(res.data);\n      page && setFilteredProducts(res.data.filter(item => Object.entries(filters).every(_ref2 => {\n        let [key, value] = _ref2;\n        return item[key].includes(value);\n      })));\n      return res.data;\n    }\n  });\n  const sortedProducts = () => {\n    if (sort === \"newest\") {\n      setFilteredProducts(prev => [...prev].sort((a, b) => a.createdAt > b.createdAt ? -1 : b.createdAt > a.createdAt ? 1 : 0));\n    } else if (sort === \"asc\") {\n      setFilteredProducts(prev => [...prev].sort((a, b) => a.price - b.price));\n    } else {\n      setFilteredProducts(prev => [...prev].sort((a, b) => b.price - a.price));\n    }\n  };\n  useEffect(() => {\n    sortedProducts();\n    // eslint-disable-next-line\n  }, [sort]);\n  useEffect(() => {\n    if (filters.category === \"\") {\n      setFilteredProducts(products);\n      sortedProducts();\n    } else if (Object.keys(filters).length > 0) {\n      setFilteredProducts(products.filter(item => Object.entries(filters).every(_ref3 => {\n        let [key, value] = _ref3;\n        return item.category.includes(value);\n      })));\n      handleChangeTo1();\n      sortedProducts();\n    }\n    // eslint-disable-next-line\n  }, [filters, products]);\n  if (isFetching) {\n    content = /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 15\n    }, this);\n  } else {\n    // setFrom(1);\n    totalPages = Math.ceil(filteredProducts.length / 20);\n    // Decide which array to render\n    const listToRender = page ? filteredProducts : products ? products.slice(0, 5) : [];\n    // If paginated view, use slice for current page\n    const paginatedList = page ? filteredProducts.slice(pages * 20, 20 * (pages + 1)) : listToRender;\n    content = /*#__PURE__*/_jsxDEV(ProductContainer, {\n      children: paginatedList && paginatedList.length > 0 ? paginatedList.map(item => /*#__PURE__*/_jsxDEV(Product, {\n        item: item\n      }, item._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 39\n      }, this)) : /*#__PURE__*/_jsxDEV(EmptyMessage, {\n        children: \"No products available\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this);\n  }\n  const handlePageChange = (event, page) => {\n    if (filteredProducts.length > 20) setPages(page - 1);\n  };\n  const handleChangeTo1 = () => {\n    setPages(0);\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [page ? /*#__PURE__*/_jsxDEV(Title, {\n      children: \"Shop With Us\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 15\n    }, this) : /*#__PURE__*/_jsxDEV(Title, {\n      children: \"Fresh Arrivals\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 45\n    }, this), content, page && /*#__PURE__*/_jsxDEV(Pagination, {\n      variant: \"outlined\",\n      count: totalPages,\n      onChange: handlePageChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 16\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 5\n  }, this);\n};\n_s(Products, \"fLBbduETDSI76ki7jTx+h+hKwcQ=\", false, function () {\n  return [useQuery];\n});\n_c = Products;\nexport default Products;\nconst Container = styled.div`\n  padding: 25px 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n`;\n_c2 = Container;\nconst ProductContainer = styled.div`\n  padding: 20px 0;\n  display: grid;\n  grid-template-columns: repeat(5, 1fr);\n  ${special({\n  \"grid-template-columns\": `repeat(3,1fr)`\n})}\n  ${tablet({\n  \"grid-template-columns\": `repeat(2,1fr)`\n})}\n  ${mobile({\n  \"grid-template-columns\": `1fr`\n})}\n`;\n_c3 = ProductContainer;\nconst Title = styled.h3`\n  font-size: 38px;\n  line-height: 1.4;\n  font-weight: 800;\n`;\n_c4 = Title;\nconst EmptyMessage = styled.div`\n  padding: 2rem 0;\n  color: #666;\n  font-weight: 600;\n  text-align: center;\n`;\n_c5 = EmptyMessage;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"Products\");\n$RefreshReg$(_c2, \"Container\");\n$RefreshReg$(_c3, \"ProductContainer\");\n$RefreshReg$(_c4, \"Title\");\n$RefreshReg$(_c5, \"EmptyMessage\");","map":{"version":3,"names":["useQuery","styled","publicRequest","mobile","special","tablet","Product","Loading","useEffect","useState","Pagination","Products","filters","sort","page","filteredProducts","setFilteredProducts","pages","setPages","content","totalPages","data","products","isFetching","queryKey","queryFn","res","get","filter","item","Object","entries","every","key","value","includes","sortedProducts","prev","a","b","createdAt","price","category","keys","length","handleChangeTo1","Math","ceil","listToRender","slice","paginatedList","map","_id","handlePageChange","event","Container","div","ProductContainer","Title","h3","EmptyMessage"],"sources":["D:/finalyear-2/Ger-s-Garage/client/src/Components/Products.jsx"],"sourcesContent":["import { useQuery } from \"@tanstack/react-query\";\r\nimport styled from \"styled-components\";\r\nimport { publicRequest } from \"../Utils/requestMethods\";\r\nimport { mobile, special, tablet } from \"../Utils/responsive\";\r\nimport Product from \"./Home/Product\";\r\nimport Loading from \"./Loading\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { Pagination } from \"@mui/material\";\r\n\r\nconst Products = ({ filters, sort, page }) => {\r\n  const [filteredProducts, setFilteredProducts] = useState([]);\r\n  const [pages, setPages] = useState(0);\r\n  let content;\r\n  let totalPages;\r\n\r\n  const { data: products, isFetching } = useQuery({\r\n    queryKey: [\"productsData\"],\r\n    queryFn: async () => {\r\n      const res = await publicRequest.get(\"/products/\");\r\n      // console.log(res.data);\r\n      page &&\r\n        setFilteredProducts(\r\n          res.data.filter((item) =>\r\n            Object.entries(filters).every(([key, value]) => item[key].includes(value))\r\n          )\r\n        );\r\n      return res.data;\r\n    },\r\n  });\r\n\r\n  const sortedProducts = () => {\r\n    if (sort === \"newest\") {\r\n      setFilteredProducts((prev) =>\r\n        [...prev].sort((a, b) =>\r\n          a.createdAt > b.createdAt ? -1 : b.createdAt > a.createdAt ? 1 : 0\r\n        )\r\n      );\r\n    } else if (sort === \"asc\") {\r\n      setFilteredProducts((prev) => [...prev].sort((a, b) => a.price - b.price));\r\n    } else {\r\n      setFilteredProducts((prev) => [...prev].sort((a, b) => b.price - a.price));\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    sortedProducts();\r\n    // eslint-disable-next-line\r\n  }, [sort]);\r\n\r\n  useEffect(() => {\r\n    if (filters.category === \"\") {\r\n      setFilteredProducts(products);\r\n      sortedProducts();\r\n    } else if (Object.keys(filters).length > 0) {\r\n      setFilteredProducts(\r\n        products.filter((item) =>\r\n          Object.entries(filters).every(([key, value]) => item.category.includes(value))\r\n        )\r\n      );\r\n      handleChangeTo1();\r\n      sortedProducts();\r\n    }\r\n    // eslint-disable-next-line\r\n  }, [filters, products]);\r\n\r\n  if (isFetching) {\r\n    content = <Loading />;\r\n  } else {\r\n    // setFrom(1);\r\n    totalPages = Math.ceil(filteredProducts.length / 20);\r\n    // Decide which array to render\r\n    const listToRender = page ? filteredProducts : products ? products.slice(0, 5) : [];\r\n    // If paginated view, use slice for current page\r\n    const paginatedList = page\r\n      ? filteredProducts.slice(pages * 20, 20 * (pages + 1))\r\n      : listToRender;\r\n\r\n    content = (\r\n      <ProductContainer>\r\n        {paginatedList && paginatedList.length > 0 ? (\r\n          paginatedList.map((item) => <Product item={item} key={item._id} />)\r\n        ) : (\r\n          <EmptyMessage>No products available</EmptyMessage>\r\n        )}\r\n      </ProductContainer>\r\n    );\r\n  }\r\n\r\n  const handlePageChange = (event, page) => {\r\n    if (filteredProducts.length > 20) setPages(page - 1);\r\n  };\r\n\r\n  const handleChangeTo1 = () => {\r\n    setPages(0);\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      {page ? <Title>Shop With Us</Title> : <Title>Fresh Arrivals</Title>}\r\n      {content}\r\n      {page && <Pagination variant=\"outlined\" count={totalPages} onChange={handlePageChange} />}\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Products;\r\n\r\nconst Container = styled.div`\r\n  padding: 25px 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\nconst ProductContainer = styled.div`\r\n  padding: 20px 0;\r\n  display: grid;\r\n  grid-template-columns: repeat(5, 1fr);\r\n  ${special({\r\n    \"grid-template-columns\": `repeat(3,1fr)`,\r\n  })}\r\n  ${tablet({\r\n    \"grid-template-columns\": `repeat(2,1fr)`,\r\n  })}\r\n  ${mobile({\r\n    \"grid-template-columns\": `1fr`,\r\n  })}\r\n`;\r\n\r\nconst Title = styled.h3`\r\n  font-size: 38px;\r\n  line-height: 1.4;\r\n  font-weight: 800;\r\n`;\r\n\r\nconst EmptyMessage = styled.div`\r\n  padding: 2rem 0;\r\n  color: #666;\r\n  font-weight: 600;\r\n  text-align: center;\r\n`;\r\n"],"mappings":";;AAAA,SAASA,QAAQ,QAAQ,uBAAuB;AAChD,OAAOC,MAAM,MAAM,mBAAmB;AACtC,SAASC,aAAa,QAAQ,yBAAyB;AACvD,SAASC,MAAM,EAAEC,OAAO,EAAEC,MAAM,QAAQ,qBAAqB;AAC7D,OAAOC,OAAO,MAAM,gBAAgB;AACpC,OAAOC,OAAO,MAAM,WAAW;AAC/B,SAASC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,UAAU,QAAQ,eAAe;AAAC;AAE3C,MAAMC,QAAQ,GAAG,QAA6B;EAAA;EAAA,IAA5B;IAAEC,OAAO;IAAEC,IAAI;IAAEC;EAAK,CAAC;EACvC,MAAM,CAACC,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGP,QAAQ,CAAC,EAAE,CAAC;EAC5D,MAAM,CAACQ,KAAK,EAAEC,QAAQ,CAAC,GAAGT,QAAQ,CAAC,CAAC,CAAC;EACrC,IAAIU,OAAO;EACX,IAAIC,UAAU;EAEd,MAAM;IAAEC,IAAI,EAAEC,QAAQ;IAAEC;EAAW,CAAC,GAAGvB,QAAQ,CAAC;IAC9CwB,QAAQ,EAAE,CAAC,cAAc,CAAC;IAC1BC,OAAO,EAAE,YAAY;MACnB,MAAMC,GAAG,GAAG,MAAMxB,aAAa,CAACyB,GAAG,CAAC,YAAY,CAAC;MACjD;MACAb,IAAI,IACFE,mBAAmB,CACjBU,GAAG,CAACL,IAAI,CAACO,MAAM,CAAEC,IAAI,IACnBC,MAAM,CAACC,OAAO,CAACnB,OAAO,CAAC,CAACoB,KAAK,CAAC;QAAA,IAAC,CAACC,GAAG,EAAEC,KAAK,CAAC;QAAA,OAAKL,IAAI,CAACI,GAAG,CAAC,CAACE,QAAQ,CAACD,KAAK,CAAC;MAAA,EAAC,CAC3E,CACF;MACH,OAAOR,GAAG,CAACL,IAAI;IACjB;EACF,CAAC,CAAC;EAEF,MAAMe,cAAc,GAAG,MAAM;IAC3B,IAAIvB,IAAI,KAAK,QAAQ,EAAE;MACrBG,mBAAmB,CAAEqB,IAAI,IACvB,CAAC,GAAGA,IAAI,CAAC,CAACxB,IAAI,CAAC,CAACyB,CAAC,EAAEC,CAAC,KAClBD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,GAAG,CAAC,CAAC,GAAGD,CAAC,CAACC,SAAS,GAAGF,CAAC,CAACE,SAAS,GAAG,CAAC,GAAG,CAAC,CACnE,CACF;IACH,CAAC,MAAM,IAAI3B,IAAI,KAAK,KAAK,EAAE;MACzBG,mBAAmB,CAAEqB,IAAI,IAAK,CAAC,GAAGA,IAAI,CAAC,CAACxB,IAAI,CAAC,CAACyB,CAAC,EAAEC,CAAC,KAAKD,CAAC,CAACG,KAAK,GAAGF,CAAC,CAACE,KAAK,CAAC,CAAC;IAC5E,CAAC,MAAM;MACLzB,mBAAmB,CAAEqB,IAAI,IAAK,CAAC,GAAGA,IAAI,CAAC,CAACxB,IAAI,CAAC,CAACyB,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAACE,KAAK,GAAGH,CAAC,CAACG,KAAK,CAAC,CAAC;IAC5E;EACF,CAAC;EAEDjC,SAAS,CAAC,MAAM;IACd4B,cAAc,EAAE;IAChB;EACF,CAAC,EAAE,CAACvB,IAAI,CAAC,CAAC;EAEVL,SAAS,CAAC,MAAM;IACd,IAAII,OAAO,CAAC8B,QAAQ,KAAK,EAAE,EAAE;MAC3B1B,mBAAmB,CAACM,QAAQ,CAAC;MAC7Bc,cAAc,EAAE;IAClB,CAAC,MAAM,IAAIN,MAAM,CAACa,IAAI,CAAC/B,OAAO,CAAC,CAACgC,MAAM,GAAG,CAAC,EAAE;MAC1C5B,mBAAmB,CACjBM,QAAQ,CAACM,MAAM,CAAEC,IAAI,IACnBC,MAAM,CAACC,OAAO,CAACnB,OAAO,CAAC,CAACoB,KAAK,CAAC;QAAA,IAAC,CAACC,GAAG,EAAEC,KAAK,CAAC;QAAA,OAAKL,IAAI,CAACa,QAAQ,CAACP,QAAQ,CAACD,KAAK,CAAC;MAAA,EAAC,CAC/E,CACF;MACDW,eAAe,EAAE;MACjBT,cAAc,EAAE;IAClB;IACA;EACF,CAAC,EAAE,CAACxB,OAAO,EAAEU,QAAQ,CAAC,CAAC;EAEvB,IAAIC,UAAU,EAAE;IACdJ,OAAO,gBAAG,QAAC,OAAO;MAAA;MAAA;MAAA;IAAA,QAAG;EACvB,CAAC,MAAM;IACL;IACAC,UAAU,GAAG0B,IAAI,CAACC,IAAI,CAAChC,gBAAgB,CAAC6B,MAAM,GAAG,EAAE,CAAC;IACpD;IACA,MAAMI,YAAY,GAAGlC,IAAI,GAAGC,gBAAgB,GAAGO,QAAQ,GAAGA,QAAQ,CAAC2B,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,EAAE;IACnF;IACA,MAAMC,aAAa,GAAGpC,IAAI,GACtBC,gBAAgB,CAACkC,KAAK,CAAChC,KAAK,GAAG,EAAE,EAAE,EAAE,IAAIA,KAAK,GAAG,CAAC,CAAC,CAAC,GACpD+B,YAAY;IAEhB7B,OAAO,gBACL,QAAC,gBAAgB;MAAA,UACd+B,aAAa,IAAIA,aAAa,CAACN,MAAM,GAAG,CAAC,GACxCM,aAAa,CAACC,GAAG,CAAEtB,IAAI,iBAAK,QAAC,OAAO;QAAC,IAAI,EAAEA;MAAK,GAAMA,IAAI,CAACuB,GAAG;QAAA;QAAA;QAAA;MAAA,QAAI,CAAC,gBAEnE,QAAC,YAAY;QAAA,UAAC;MAAqB;QAAA;QAAA;QAAA;MAAA;IACpC;MAAA;MAAA;MAAA;IAAA,QAEJ;EACH;EAEA,MAAMC,gBAAgB,GAAG,CAACC,KAAK,EAAExC,IAAI,KAAK;IACxC,IAAIC,gBAAgB,CAAC6B,MAAM,GAAG,EAAE,EAAE1B,QAAQ,CAACJ,IAAI,GAAG,CAAC,CAAC;EACtD,CAAC;EAED,MAAM+B,eAAe,GAAG,MAAM;IAC5B3B,QAAQ,CAAC,CAAC,CAAC;EACb,CAAC;EAED,oBACE,QAAC,SAAS;IAAA,WACPJ,IAAI,gBAAG,QAAC,KAAK;MAAA,UAAC;IAAY;MAAA;MAAA;MAAA;IAAA,QAAQ,gBAAG,QAAC,KAAK;MAAA,UAAC;IAAc;MAAA;MAAA;MAAA;IAAA,QAAQ,EAClEK,OAAO,EACPL,IAAI,iBAAI,QAAC,UAAU;MAAC,OAAO,EAAC,UAAU;MAAC,KAAK,EAAEM,UAAW;MAAC,QAAQ,EAAEiC;IAAiB;MAAA;MAAA;MAAA;IAAA,QAAG;EAAA;IAAA;IAAA;IAAA;EAAA,QAC/E;AAEhB,CAAC;AAAC,GA9FI1C,QAAQ;EAAA,QAM2BX,QAAQ;AAAA;AAAA,KAN3CW,QAAQ;AAgGd,eAAeA,QAAQ;AAEvB,MAAM4C,SAAS,GAAGtD,MAAM,CAACuD,GAAI;AAC7B;AACA;AACA;AACA;AACA;AACA,CAAC;AAAC,MANID,SAAS;AAOf,MAAME,gBAAgB,GAAGxD,MAAM,CAACuD,GAAI;AACpC;AACA;AACA;AACA,IAAIpD,OAAO,CAAC;EACR,uBAAuB,EAAG;AAC5B,CAAC,CAAE;AACL,IAAIC,MAAM,CAAC;EACP,uBAAuB,EAAG;AAC5B,CAAC,CAAE;AACL,IAAIF,MAAM,CAAC;EACP,uBAAuB,EAAG;AAC5B,CAAC,CAAE;AACL,CAAC;AAAC,MAbIsD,gBAAgB;AAetB,MAAMC,KAAK,GAAGzD,MAAM,CAAC0D,EAAG;AACxB;AACA;AACA;AACA,CAAC;AAAC,MAJID,KAAK;AAMX,MAAME,YAAY,GAAG3D,MAAM,CAACuD,GAAI;AAChC;AACA;AACA;AACA;AACA,CAAC;AAAC,MALII,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}